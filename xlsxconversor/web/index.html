<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Login â€” XLSX Conversor</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<main class="center-container">
<div class="card" style="animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);">
<div class="logo-container" style="text-align: center; margin-bottom: 2rem;">
<img src="assets/logo.png" alt="Logo" class="logo" onerror="this.style.display='none'">
</div>

<form id="loginForm" style="opacity: 0; animation: fadeInUp 0.6s ease-out 0.3s forwards;">
<div class="form-group">
<label for="username" style="transform: translateY(0); transition: all 0.3s ease-out;">
ðŸ‘¤ UsuÃ¡rio
</label>
<div style="position: relative;">
<input id="username" name="username" type="text" required 
       style="padding-left: 1rem; font-size: 1rem; transition: all 0.3s ease-out;"
       placeholder="Digite seu usuÃ¡rio">
</div>
</div>

<div class="form-group">
<label for="password" style="transform: translateY(0); transition: all 0.3s ease-out;">
ðŸ”’ Senha
</label>
<div style="position: relative;">
<input id="password" name="password" type="password" required 
       style="padding-left: 1rem; font-size: 1rem; transition: all 0.3s ease-out;"
       placeholder="Digite sua senha">
</div>
</div>

<button type="submit" id="loginButton" style="
  width: 100%;
  font-size: 1.1rem;
  font-weight: 600;
  padding: 1rem;
  position: relative;
  overflow: hidden;
  animation: scaleIn 0.4s cubic-bezier(0.4, 0, 0.2, 1) 0.6s both;
">
<span id="loginButtonText">Entrar</span>
<div class="button-ripple" style="
  position: absolute;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: scale(0);
  animation: ripple 0.6s linear;
  pointer-events: none;
"></div>
</button>

<p id="loginMessage" class="message" style="text-align: center; margin-top: 1rem; opacity: 0; transform: translateY(10px); transition: all 0.3s ease-out;"></p>
</form>

<div class="additional-info" style="
  margin-top: 2rem;
  padding: 1.5rem;
  background: rgba(99, 102, 241, 0.05);
  border-radius: var(--radius-lg);
  border: 1px solid rgba(99, 102, 241, 0.1);
  text-align: center;
  animation: fadeInUp 0.6s ease-out 0.9s both;
">
<h4 style="margin: 0 0 0.5rem; color: var(--text-primary); font-size: 0.875rem;">ðŸ“‹ Sistema XLSX Conversor</h4>
<p style="margin: 0; color: var(--text-secondary); font-size: 0.75rem;">
Converta seus arquivos Excel de forma rÃ¡pida e segura
</p>
</div>
</div>
</main>

<script src="js/api.js"></script>
<script src="js/auth.js"></script>
<script>
// JavaScript Melhorado para Login
document.addEventListener('DOMContentLoaded', function() {
const form = document.getElementById('loginForm');
const usernameInput = document.getElementById('username');
const passwordInput = document.getElementById('password');
const loginButton = document.getElementById('loginButton');
const loginMessage = document.getElementById('loginMessage');
const loginButtonText = document.getElementById('loginButtonText');

// Adicionar estilos CSS inline
const style = document.createElement('style');
style.textContent = `
.form-group input:focus + span,
.form-group input:focus ~ span {
  color: var(--primary) !important;
  transform: translateY(-50%) scale(1.1);
}

.form-group label:has(input:focus) {
  color: var(--primary) !important;
}

input[type="checkbox"] {
  accent-color: var(--primary);
}

.login-success {
  background: linear-gradient(135deg, #10b981 0%, #34d399 100%) !important;
}

.login-error {
  background: linear-gradient(135deg, #ef4444 0%, #f87171 100%) !important;
}

.message.show {
  opacity: 1 !important;
  transform: translateY(0) !important;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

.logo-container {
  animation: float 3s ease-in-out infinite;
}
`;
document.head.appendChild(style);

// FunÃ§Ã£o para adicionar ripple effect
function adicionarRippleEffect(event) {
  const button = event.currentTarget;
  const ripple = button.querySelector('.button-ripple');
  const rect = button.getBoundingClientRect();
  const size = Math.max(rect.width, rect.height);
  const x = event.clientX - rect.left - size / 2;
  const y = event.clientY - rect.top - size / 2;
  
  ripple.style.width = ripple.style.height = size + 'px';
  ripple.style.left = x + 'px';
  ripple.style.top = y + 'px';
  ripple.style.animation = 'none';
  
  // Trigger reflow
  ripple.offsetHeight;
  
  ripple.style.animation = 'ripple 0.6s linear';
}

// FunÃ§Ã£o para animar inputs
function animarInputs() {
  const inputs = document.querySelectorAll('input[type="text"], input[type="password"]');
  
  inputs.forEach((input, index) => {
    // Animar entrada
    input.style.opacity = '0';
    input.style.transform = 'translateY(20px)';
    
    setTimeout(() => {
      input.style.opacity = '1';
      input.style.transform = 'translateY(0)';
      input.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
    }, 400 + (index * 100));
    
    // Adicionar focus/blur effects
    input.addEventListener('focus', function() {
      this.parentElement.querySelector('span').style.color = 'var(--primary)';
      this.parentElement.querySelector('span').style.transform = 'translateY(-50%) scale(1.1)';
      this.style.borderColor = 'var(--primary)';
      this.style.boxShadow = '0 0 0 3px rgba(99, 102, 241, 0.1)';
      this.parentElement.style.transform = 'translateY(-2px)';
    });
    
    input.addEventListener('blur', function() {
      this.parentElement.querySelector('span').style.color = 'var(--text-muted)';
      this.parentElement.querySelector('span').style.transform = 'translateY(-50%) scale(1)';
      this.style.borderColor = '';
      this.style.boxShadow = '';
      this.parentElement.style.transform = 'translateY(0)';
    });
    
    // Adicionar validaÃ§Ã£o em tempo real
    input.addEventListener('input', function() {
      if (this.value.length > 0) {
        this.style.borderColor = 'var(--success)';
        this.parentElement.querySelector('span').style.color = 'var(--success)';
      } else {
        this.style.borderColor = '';
        this.parentElement.querySelector('span').style.color = 'var(--text-muted)';
      }
    });
  });
}

// FunÃ§Ã£o para mostrar mensagem de feedback
function mostrarMensagem(texto, tipo = 'error') {
  loginMessage.textContent = texto;
  loginMessage.className = `message ${tipo} show`;
  
  // Animar shake no card se for erro
  if (tipo === 'error') {
    const card = document.querySelector('.card');
    card.style.animation = 'shake 0.5s ease-out';
    setTimeout(() => {
      card.style.animation = '';
    }, 500);
  }
  
  // Remover mensagem apÃ³s 5 segundos
  setTimeout(() => {
    loginMessage.classList.remove('show');
    setTimeout(() => {
      loginMessage.textContent = '';
    }, 300);
  }, 5000);
}

// FunÃ§Ã£o para animar botÃ£o de login
function animarBotaoLogin(loading = false) {
  if (loading) {
    loginButton.disabled = true;
    loginButton.classList.add('loading');
    loginButtonText.innerHTML = '<div class="spinner"></div> Entrando...';
  } else {
    loginButton.disabled = false;
    loginButton.classList.remove('loading');
    loginButtonText.innerHTML = 'Entrar';
  }
}

// Event listeners
loginButton.addEventListener('click', adicionarRippleEffect);

form.addEventListener('submit', async (e) => {
e.preventDefault();
const user = usernameInput.value.trim();
const pass = passwordInput.value.trim();

if (!user || !pass) {
mostrarMensagem('Por favor, preencha todos os campos');
return;
}

loginMessage.textContent = '';
animarBotaoLogin(true);

try {
const res = await apiRequest('/login/', 'POST', { 
username: user, 
password: pass 
});

if (res && res.token) {
localStorage.setItem('token', res.token);
localStorage.setItem('username', user);

// Animar sucesso
loginButton.classList.remove('loading');
loginButton.classList.add('login-success');
loginButtonText.innerHTML = 'âœ… Entrando...';

// Animar saÃ­da
setTimeout(() => {
const card = document.querySelector('.card');
card.style.animation = 'fadeInUp 0.6s ease-out reverse';
setTimeout(() => {
window.location = 'dashboard.html';
}, 600);
}, 1000);

} else {
mostrarMensagem(res.detail || 'UsuÃ¡rio ou senha incorretos');
animarBotaoLogin(false);
}
} catch (err) {
console.error(err);
mostrarMensagem('Erro de conexÃ£o. Verifique sua internet e tente novamente.');
animarBotaoLogin(false);
}
});

// Adicionar Enter key support
[usernameInput, passwordInput].forEach(input => {
input.addEventListener('keypress', function(e) {
if (e.key === 'Enter') {
form.dispatchEvent(new Event('submit'));
}
});
});

// Adicionar Remember me functionality
const rememberCheckbox = document.getElementById('lembrarSenha');
if (rememberCheckbox) {
rememberCheckbox.addEventListener('change', function() {
if (this.checked && usernameInput.value) {
localStorage.setItem('rememberedUser', usernameInput.value);
} else {
localStorage.removeItem('rememberedUser');
}
});
}

// Carregar usuÃ¡rio lembrado
const rememberedUser = localStorage.getItem('rememberedUser');
if (rememberedUser) {
usernameInput.value = rememberedUser;
rememberCheckbox.checked = true;
}

// Inicializar animaÃ§Ãµes
animarInputs();

// Adicionar efeito de partÃ­culas de fundo (opcional)
function criarParticulas() {
const particulas = document.createElement('div');
particulas.style.cssText = `
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
pointer-events: none;
z-index: -1;
overflow: hidden;
`;

for (let i = 0; i < 20; i++) {
const particula = document.createElement('div');
particula.style.cssText = `
position: absolute;
width: 4px;
height: 4px;
background: var(--primary);
border-radius: 50%;
opacity: 0.1;
animation: float ${3 + Math.random() * 4}s ease-in-out infinite;
left: ${Math.random() * 100}%;
top: ${Math.random() * 100}%;
animation-delay: ${Math.random() * 2}s;
`;

particulas.appendChild(particula);
}

document.body.appendChild(particulas);
}

// Criar partÃ­culas apÃ³s um delay
setTimeout(criarParticulas, 2000);

// Theme toggle (futuro)
function toggleTheme() {
const html = document.documentElement;
const currentTheme = html.getAttribute('data-theme') || 'light';
const newTheme = currentTheme === 'light' ? 'dark' : 'light';

html.setAttribute('data-theme', newTheme);
localStorage.setItem('theme', newTheme);
}

// Prevenir auto-complete precoce
setTimeout(() => {
usernameInput.focus();
}, 1000);
});
</script>
</body>
</html>